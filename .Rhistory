geom_bar(aes(x = actors), fill = "blue") +
xlab("Device") + ylab("Count")
ggplot(df2[1:20,]) +
geom_bar(aes(x = actors, y = num_episodes), fill = "blue") +
xlab("Device") + ylab("Count")
names(df)
df2
rep(df2$characters, times = df2$num_episodes)
df3 = data.frame (characters = rep(df2$characters, times = df2$num_episodes))
df3
ggplot(df3]) +
ggplot(df3) +
geom_bar(aes(x = characters), fill = "blue") +
xlab("Device") + ylab("Count")
table(df3)
ggplot(df3[1:100,]) +
geom_bar(aes(x = characters), fill = "blue") +
xlab("Device") + ylab("Count")
ggplot(df3[1:100,]) +
geom_bar(aes(x = characters), fill = "blue") +
xlab("Device") + ylab("Count")
ggplot(df3[1:100,]) +
geom_bar(aes(x = characters), fill = "blue") +
xlab("caacters") + ylab("Count")
df3[1:100,]
class(df3[1:100,])
ggplot(as.dataframe(df3[1:100,])) +
geom_bar(aes(x = characters), fill = "blue") +
xlab("caacters") + ylab("Count")
ggplot(as.data.frame(df3[1:100,])) +
geom_bar(aes(x = characters), fill = "blue") +
xlab("caacters") + ylab("Count")
ggplot(as.data.frame(df3[1:100,])) +
geom_bar(aes(x = characters), fill = "blue") +
xlab("caacters") + ylab("Count")
ggplot(as.data.frame(df3[1:100,]), aes(x = characters)) +
geom_bar(, fill = "blue") +
xlab("caacters") + ylab("Count")
class(df3)
df3 <- df3[1:100,]
class(df3)
df3 <- as.fata.frame(df3[1:100,])
df3 <- as.data.frame(df3[1:100,])
df3 <- as.data.frame(df3[1:100,:])
df3 <- as.data.frame(df3[1:100,1])
df3 <- as.data.frame(df3[1:100,1:1])
df3 <- as.data.frame(df3[1:100,0:1])
df3 <- as.data.frame(df3[1:100,c(!)])
df3 <- as.data.frame(df3[1:100,c(1)])
dim(df3)
df3 = data.frame (characters = rep(df2$characters, times = df2$num_episodes))
dim(df3)
ggplot(df3), aes(x = characters)) +
dim(df3)
ggplot(df3), aes(x = characters)) +
ggplot(df3, aes(x = characters)) +
geom_bar(, fill = "blue") +
xlab("Characters") + ylab("Count")
ggplot(df3, aes(x = characters)) +
geom_bar(, fill = "blue") +
xlab("Characters") + ylab("Count",) +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
ggplot(df3, aes(x = characters)) +
geom_bar(, fill = "blue") +
xlab("Characters") + ylab("Count",) +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
ggplot(df3, aes(x = characters)) +
geom_bar(, fill = "blue") +
xlab("Characters") + ylab("Count") +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
df4 <- df3 %>% group_by(characters) %>%   mutate(count_name_occurr = n())
df4
g2<-ggplot(data=df4, aes(x=reorder(characters,count_name_occurr), fill=type)) +
geom_bar(stat="count")
g2
g2<-ggplot(data=df4, aes(x=reorder(characters,count_name_occurr), fill="red")) +
geom_bar(stat="count")
g2
g2<-ggplot(data=df4, aes(x=reorder(characters,-count_name_occurr), fill="red")) +
geom_bar(stat="count")
g2
g2<-ggplot(data=df4, aes(x=reorder(characters,-count_name_occurr), fill="blue")) +
geom_bar(stat="count")+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
g2
df4[200:210]
df4[200:210]
df4[200:210,]
df4[600:610,]
g2<-ggplot(data=df4[1:603,], aes(x=reorder(characters,-count_name_occurr), fill="blue")) +
geom_bar(stat="count")+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
g2
df4
table(df4)
g2<-ggplot(data=df4[1:603,], aes(x=reorder(characters,-count_name_occurr), fill="blue")) +
geom_bar(stat="count")+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
g2
g2<-ggplot(data=df4[1:603,], aes(x=reorder(characters,-count_name_occurr), fill="blue")) +
geom_bar(stat="count", fill = "blue")+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
g2
geom_bar(aes(x=reorder(characters[1:603],-count_name_occurr), stat="count", fill = "blue")+
g2
geom_bar(aes(x=reorder(characters[1:603],-ount_name_occurr), stat="count", fill = "blue")+
geom_bar(aes(x=reorder(characters[1:603],count_name_occurr), stat="count", fill = "blue")+
g2
table(df4)
geom_bar(aes(x=reorder(characters[1:603],count_name_occurr), fill = "blue")+
g2
g2<-ggplot(data=df4[1:603,], , fill="blue")) +
g2
ggplot(data=df4[1:603,], , fill="blue")) +
geom_bar(aes(x=reorder(characters[1:603],count_name_occurr), fill = "blue"))+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
g2
geom_bar(aes(x=reorder(characters[1:603],count_name_occurr), fill = "blue"))+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
ggplot(data=df4[1:603,], fill="blue")) +
table(df4)
ggplot(data=df4[1:603,], fill="blue")) +
x <- c(2,3,4)
y <- c(1,3,5)
x*y
x*5
pnorm(mean = 2500,sd = 500)
pnorm(mean = 2500,sd = 500,q=c(1900,3100))
qnorm(mean = 2500,sd = 500,q=c(1900,3100))
qnorm(mean = 2500,sd = 500,p=c(1900,3100))
pnorm(mean = 2500,sd = 500,p=c(1900,3100))
pnorm(mean = 2500,sd = 500,1=c(1900,3100))
pnorm(mean = 2500,sd = 500,p=c(1900,3100))
pnorm(mean = 2500,sd = 500,p=(1900,3100))
pnorm(mean = 2500,sd = 500)
pnorm(mean = 2500,sd = 500, q=2500)
pnorm(mean = 2500,sd = 500, q=3100)- pnorm(mean = 2500,sd = 500, q=1900 )
library(ggplot2)
library(dplyr)
library(ggthemes)
library(hrbrthemes)
library(ggsci)
library(extrafont)
library(showtext)
library(systemfonts)
data <- read.csv('API_SP.ADO.TFRT_DS2_en_csv_v2_4772546.csv',skip = 4)
setwd("/Users/juanpablo/Documents/R/Adolescent fertility rate (births per 1,000 women ages 15-19)/Adolescent-fertility-rate")
data <- read.csv('API_SP.ADO.TFRT_DS2_en_csv_v2_4772546.csv',skip = 4)
metadata <- read.csv('Metadata_Country_API_SP.ADO.TFRT_DS2_en_csv_v2_4772546.csv')
tileURL <- "https://gist.githubusercontent.com/maartenzam/787498bbc07ae06b637447dbd430ea0a/raw/9a9dafafb44d8990f85243a9c7ca349acd3a0d07/worldtilegrid.csv"
tile <- read.csv(tileURL)
data <- data[c(1,2,3,63,64,65)]
metadata <- metadata[c(1,2,3,5)]
tile<-merge(x=tile, y=metadata,
all.x=TRUE,
all.y = FALSE ,
by.x = 'alpha.3',
by.y ='Country.Code')
data <- data[complete.cases(data),]
metadata <- metadata[complete.cases(metadata),]
###### left join in R using merge() function
df = merge(x=data, y=metadata,
all.x=TRUE,
all.y = FALSE ,
by.x = 'Country.Code' ,
by.y ='Country.Code')
df<- df %>%
group_by(Region) %>%
mutate(X2020_ratio = mean(X2020, na.rm = FALSE))%>%
ungroup()
df <-df[df$Region!="",]
#plot
ggplot(data = df, aes(x=Region, y=X2020))+
geom_boxplot()
#sort the data
ggplot(df, aes(x = reorder(Region,-X2020), y = X2020)) +
geom_boxplot()
#flip axis
ggplot(df, aes(x = reorder(Region,-X2020), y = X2020)) +
geom_boxplot() +
coord_flip() +
scale_y_continuous(limits = c(0, 180))
#change the theme
theme_set(theme_light())
g <-
ggplot(df, aes(x = reorder(Region,-X2020), y = X2020, color = Region)) +
coord_flip() +
scale_y_continuous(limits = c(0, 190)) +
scale_color_uchicago() +
labs(x = NULL, y = "Adolescent fertility rate")+
theme(
legend.position = "none",
axis.title = element_text(size = 12),
axis.text.x = element_text(family = NULL, size = 12),
panel.grid = element_blank()
)
g + geom_boxplot()
g + geom_violin()
g + geom_line(size=1)
g + geom_point(size=1)
g +   geom_point(size = 3, alpha = 0.15)
g +   geom_boxplot(color = "gray60", outlier.alpha = 0) +
geom_point(size = 3, alpha = 0.15)
set.seed(9613)
g + geom_jitter(size = 2, alpha = 0.25, width = 0.2)
g + geom_jitter(position = position_jitter(seed = 2019, width = 0.2), size = 2, alpha = 0.25)
g +
geom_jitter(size = 2, alpha = 0.25, width = 0.2) +
stat_summary(fun = mean, geom = "point", size = 5)
#Line with world average
world_avg <-
df %>%
summarize(avg = median(X2020, na.rm = TRUE)) %>%
pull(avg)
world_avg
g +
geom_hline(aes(yintercept = world_avg), color = "gray70", size = 0.6) +
stat_summary(fun = mean, geom = "point", size = 5) +
geom_jitter(size = 2, alpha = 0.25, width = 0.2)
# lines from region mean to the world's mean
g +
geom_segment(
aes(x = reorder(Region,-X2020), xend = reorder(Region,-X2020),
y = world_avg, yend =X2020_ratio ),
size = 0.8
) +
geom_hline(aes(yintercept = world_avg), color = "gray70", size = 0.6) +
geom_jitter(size = 2, alpha = 0.25, width = 0.2) +
stat_summary(fun = mean, geom = "point", size = 5)
#adding the text
(g_text <-
g +
geom_segment(
aes(x = reorder(Region,-X2020), xend = reorder(Region,-X2020),
y = world_avg, yend =X2020_ratio ),
size = 0.8
) +
geom_hline(aes(yintercept = world_avg), color = "gray70", size = 0.6) +
geom_jitter(position = position_jitter(seed = 1996, width = 0.2), size = 2, alpha = 0.25) +
stat_summary(fun = mean, geom = "point", size = 5)+
annotate(
"text", x = 7, y = 85, size = 2.8, color = "gray20", lineheight = .9,
label = glue::glue("Worldwide average:\n{round(world_avg, 1)} births per 1,000 women ages 15-19")
) +
annotate(
"text", x = 3.5, y = 120, size = 2.8, color = "gray20",
label = "Countries per Region"
) +
annotate(
"text", x = 1.6, y = 140, size = 2.8, color = "gray20", lineheight = .9,
label = "Sub-Saharan Africa has by far\nthe most births per adolescent")
)
summary(df)
which(max(df$X2020))
where(max(df$X2020))
which.max(df$X2020)
maximo.position <- which.max(df$X2020)
df[maximo.position,]
#adding the text
(g_text <-
g +
geom_segment(
aes(x = reorder(Region,-X2020), xend = reorder(Region,-X2020),
y = world_avg, yend =X2020_ratio ),
size = 0.8
) +
geom_hline(aes(yintercept = world_avg), color = "gray70", size = 0.6) +
geom_jitter(position = position_jitter(seed = 1996, width = 0.2), size = 2, alpha = 0.25) +
stat_summary(fun = mean, geom = "point", size = 5)+
annotate(
"text", x = 7, y = 85, size = 2.8, color = "gray20", lineheight = .9,
label = glue::glue("Worldwide average:\n{round(world_avg, 1)} births per 1,000 women ages 15-19")
) +
annotate(
"text", x = 3.5, y = 120, size = 2.8, color = "gray20",
label = "Countries per Region"
) +
annotate(
"text", x = 1.6, y = 140, size = 2.8, color = "gray20", lineheight = .9,
label = "{df$Country.Name[maximo.position]} has by far\nthe most births per adolescent")
)
#adding the text
(g_text <-
g +
geom_segment(
aes(x = reorder(Region,-X2020), xend = reorder(Region,-X2020),
y = world_avg, yend =X2020_ratio ),
size = 0.8
) +
geom_hline(aes(yintercept = world_avg), color = "gray70", size = 0.6) +
geom_jitter(position = position_jitter(seed = 1996, width = 0.2), size = 2, alpha = 0.25) +
stat_summary(fun = mean, geom = "point", size = 5)+
annotate(
"text", x = 7, y = 85, size = 2.8, color = "gray20", lineheight = .9,
label = glue::glue("Worldwide average:\n{round(world_avg, 1)} births per 1,000 women ages 15-19")
) +
annotate(
"text", x = 3.5, y = 120, size = 2.8, color = "gray20",
label = "Countries per Region"
) +
annotate(
"text", x = 1.6, y = 140, size = 2.8, color = "gray20", lineheight = .9,
label = df$Country.Name[maximo.position] "has by far\nthe most births per adolescent")
#adding the text
(g_text <-
g +
geom_segment(
aes(x = reorder(Region,-X2020), xend = reorder(Region,-X2020),
y = world_avg, yend =X2020_ratio ),
size = 0.8
) +
geom_hline(aes(yintercept = world_avg), color = "gray70", size = 0.6) +
geom_jitter(position = position_jitter(seed = 1996, width = 0.2), size = 2, alpha = 0.25) +
stat_summary(fun = mean, geom = "point", size = 5)+
annotate(
"text", x = 7, y = 85, size = 2.8, color = "gray20", lineheight = .9,
label = glue::glue("Worldwide average:\n{round(world_avg, 1)} births per 1,000 women ages 15-19")
) +
annotate(
"text", x = 3.5, y = 120, size = 2.8, color = "gray20",
label = "Countries per Region"
) +
annotate(
"text", x = 1.6, y = 140, size = 2.8, color = "gray20", lineheight = .9,
label = df$Country.Name[maximo.position] "has by far\nthe most births per adolescent")
#adding the text
(g_text <-
g +
geom_segment(
aes(x = reorder(Region,-X2020), xend = reorder(Region,-X2020),
y = world_avg, yend =X2020_ratio ),
size = 0.8
) +
geom_hline(aes(yintercept = world_avg), color = "gray70", size = 0.6) +
geom_jitter(position = position_jitter(seed = 1996, width = 0.2), size = 2, alpha = 0.25) +
stat_summary(fun = mean, geom = "point", size = 5)+
annotate(
"text", x = 7, y = 85, size = 2.8, color = "gray20", lineheight = .9,
label = glue::glue("Worldwide average:\n{round(world_avg, 1)} births per 1,000 women ages 15-19")
) +
annotate(
"text", x = 3.5, y = 120, size = 2.8, color = "gray20",
label = "Countries per Region"
) +
annotate(
"text", x = 1.6, y = 140, size = 2.8, color = "gray20", lineheight = .9,
label = str(df$Country.Name[maximo.position]) "has by far\nthe most births per adolescent")
df$Country.Name[maximo.position]
str(df$Country.Name[maximo.position])
#adding the text
(g_text <-
g +
geom_segment(
aes(x = reorder(Region,-X2020), xend = reorder(Region,-X2020),
y = world_avg, yend =X2020_ratio ),
size = 0.8
) +
geom_hline(aes(yintercept = world_avg), color = "gray70", size = 0.6) +
geom_jitter(position = position_jitter(seed = 1996, width = 0.2), size = 2, alpha = 0.25) +
stat_summary(fun = mean, geom = "point", size = 5)+
annotate(
"text", x = 7, y = 85, size = 2.8, color = "gray20", lineheight = .9,
label = glue::glue("Worldwide average:\n{round(world_avg, 1)} births per 1,000 women ages 15-19")
) +
annotate(
"text", x = 3.5, y = 120, size = 2.8, color = "gray20",
label = "Countries per Region"
) +
annotate(
"text", x = 1.6, y = 140, size = 2.8, color = "gray20", lineheight = .9,
label =  "{str(df$Country.Name[maximo.position])} has by far\nthe most births per adolescent")
)
#adding the text
(g_text <-
g +
geom_segment(
aes(x = reorder(Region,-X2020), xend = reorder(Region,-X2020),
y = world_avg, yend =X2020_ratio ),
size = 0.8
) +
geom_hline(aes(yintercept = world_avg), color = "gray70", size = 0.6) +
geom_jitter(position = position_jitter(seed = 1996, width = 0.2), size = 2, alpha = 0.25) +
stat_summary(fun = mean, geom = "point", size = 5)+
annotate(
"text", x = 7, y = 85, size = 2.8, color = "gray20", lineheight = .9,
label = glue::glue("Worldwide average:\n{round(world_avg, 1)} births per 1,000 women ages 15-19")
) +
annotate(
"text", x = 3.5, y = 120, size = 2.8, color = "gray20",
label = "Countries per Region"
) +
annotate(
"text", x = 1.6, y = 140, size = 2.8, color = "gray20", lineheight = .9,
label =  "\n{str(df$Country.Name[maximo.position])} has by far\nthe most births per adolescent")
)
#adding the text
(g_text <-
g +
geom_segment(
aes(x = reorder(Region,-X2020), xend = reorder(Region,-X2020),
y = world_avg, yend =X2020_ratio ),
size = 0.8
) +
geom_hline(aes(yintercept = world_avg), color = "gray70", size = 0.6) +
geom_jitter(position = position_jitter(seed = 1996, width = 0.2), size = 2, alpha = 0.25) +
stat_summary(fun = mean, geom = "point", size = 5)+
annotate(
"text", x = 7, y = 85, size = 2.8, color = "gray20", lineheight = .9,
label = glue::glue("Worldwide average:\n{round(world_avg, 1)} births per 1,000 women ages 15-19")
) +
annotate(
"text", x = 3.5, y = 120, size = 2.8, color = "gray20",
label = "Countries per Region"
) +
annotate(
"text", x = 1.6, y = 140, size = 2.8, color = "gray20", lineheight = .9,
label =  "\n{df$Country.Name[maximo.position]} has by far\nthe most births per adolescent")
)
#adding the text
#adding the text
#adding the text
(g_text <-
g +
geom_segment(
aes(x = reorder(Region,-X2020), xend = reorder(Region,-X2020),
y = world_avg, yend =X2020_ratio ),
size = 0.8
) +
geom_hline(aes(yintercept = world_avg), color = "gray70", size = 0.6) +
geom_jitter(position = position_jitter(seed = 1996, width = 0.2), size = 2, alpha = 0.25) +
stat_summary(fun = mean, geom = "point", size = 5)+
annotate(
"text", x = 7, y = 85, size = 2.8, color = "gray20", lineheight = .9,
label = glue::glue("Worldwide average:\n{round(world_avg, 1)} births per 1,000 women ages 15-19")
) +
annotate(
"text", x = 3.5, y = 120, size = 2.8, color = "gray20",
label = "Countries per Region"
) +
annotate(
"text", x = 1.6, y = 140, size = 2.8, color = "gray20", lineheight = .9,
label =  glue::glue("A {df$Country.Name[maximo.position]} has by far\nthe most births per adolescent")
)
)
#adding the text
(g_text <-
g +
geom_segment(
aes(x = reorder(Region,-X2020), xend = reorder(Region,-X2020),
y = world_avg, yend =X2020_ratio ),
size = 0.8
) +
geom_hline(aes(yintercept = world_avg), color = "gray70", size = 0.6) +
geom_jitter(position = position_jitter(seed = 1996, width = 0.2), size = 2, alpha = 0.25) +
stat_summary(fun = mean, geom = "point", size = 5)+
annotate(
"text", x = 7, y = 85, size = 2.8, color = "gray20", lineheight = .9,
label = glue::glue("Worldwide average:\n{round(world_avg, 1)} births per 1,000 women ages 15-19")
) +
annotate(
"text", x = 3.5, y = 120, size = 2.8, color = "gray20",
label = "Countries per Region"
) +
annotate(
"text", x = 1.6, y = 140, size = 2.8, color = "gray20", lineheight = .9,
label =  glue::glue("{df$Country.Name[maximo.position]} has by far\nthe most births per adolescent")
)
)
#adding the arrows
arrows <-
tibble(
x1 = c(6.8, 3.5, 3.5, 1.5),
x2 = c(6.4, 3.8, 3.1, 1),
y1 = c(50, 99, 99, 169),
y2 = c(world_avg, 81, 83, 177.464)
)
(g_arrows <- g_text +
geom_curve(
data = arrows, aes(x = x1, y = y1, xend = x2, yend = y2),
arrow = arrow(length = unit(0.07, "inch")), size = 0.4,
color = "gray20", curvature = -0.3
)
)
(map_regions <-
tile %>%
ggplot(aes(x = x, y = y, fill = Region, color = Region)) +
geom_tile(color = "white") +
scale_y_reverse() +
ggsci::scale_fill_uchicago(guide = "none") +
coord_equal() +
theme(line = element_blank(),
panel.background = element_rect(fill = "transparent"),
plot.background = element_rect(fill = "transparent", color = "transparent"),
panel.border = element_rect(color = "transparent"),
strip.background = element_rect(color = "gray20"),
axis.text = element_blank(),
plot.margin = margin(0, 0, 0, 0)) +
labs(x = NULL, y = NULL)
)
#adding the source
(g_final <-
g_arrows +
scale_y_continuous(
limits = c(1, NA), expand = c(0.02, 0.02),
breaks = c(1, seq(20, 190, by = 20))
) +
labs(caption = "Data: The World Bank\nVisualisation by JuanBioData") +
theme(plot.caption = element_text(size = 9, color = "gray50"))
)
#Final map
g_final +
annotation_custom(ggplotGrob(map_regions), xmin = 4, xmax = 7, ymin = 120, ymax = 180)
